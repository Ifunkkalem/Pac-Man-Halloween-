<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Leaderboard</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body{
  font-family:Trebuchet MS;
  background:#0b0b0b;
  color:#fff;
  padding:16px
}
h2{color:#00ffd5;text-shadow:0 0 10px #00ffd5}
ul{list-style:none;padding:0}
li{
  padding:10px;
  margin-bottom:8px;
  border-radius:10px;
  background:linear-gradient(90deg,#ff0000,#00ff9d);
  color:#000;
  font-weight:bold
}
</style>
</head>
<body>

<h2>üèÜ TOP 10 PACMAN SOMNIA</h2>
<ul id="leaderboard-list">Loading...</ul>

<script>
(async function(){

  const CONTRACT = "0xD76b767102f2610b0C97FEE84873c1fAA4c7C365";

  const ABI = [
    {"inputs":[{"internalType":"address","name":"_treasury","type":"address"},{"internalType":"uint256","name":"_startFeeWei","type":"uint256"},{"internalType":"uint256","name":"_maxScorePerSubmit","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},
    {"inputs":[],"name":"getTop10","outputs":[{"internalType":"address[]","name":"topPlayers","type":"address[]"},{"internalType":"uint256[]","name":"scores","type":"uint256[]"}],"stateMutability":"view","type":"function"}
  ];

  try {
    // ‚úÖ PAKAI RPC READ-ONLY (TIDAK BUTUH WALLET)
    const RPC = "https://rpc.somnia.network";  // jika nanti kamu punya RPC resmi lain, boleh ganti
    const provider = new ethers.providers.JsonRpcProvider(RPC);

    const contract = new ethers.Contract(CONTRACT, ABI, provider);
    const res = await contract.getTop10();

    const players = res[0];
    const scores  = res[1];

    const ul = document.getElementById('leaderboard-list');
    ul.innerHTML = "";

    if (players.length === 0) {
      ul.innerHTML = "<li>Belum ada skor</li>";
      return;
    }

    for (let i = 0; i < players.length; i++) {
      const li = document.createElement("li");
      li.textContent = `${i+1}. ${players[i]} ‚Äî ${scores[i].toString()} PTS`;
      ul.appendChild(li);
    }

  } catch (e) {
    console.error("Leaderboard Error:", e);
    document.getElementById('leaderboard-list').innerHTML = "<li>Gagal memuat leaderboard</li>";
  }

})();
</script>

</body>
</html>
